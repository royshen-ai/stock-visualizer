# 股票交易可视化工具

这是一个用于分析股票交易记录并可视化K线图的工具集。可以导入CSV格式的交易数据，显示股票K线图，并在图上标记买卖点位。

## 功能特点

- 📊 支持导入CSV格式的股票交易数据
- 📈 自动获取股票K线数据
- 🎯 在K线图上标记买入/卖出位置
- 📋 显示交易统计和明细
- 🖥️ 提供Web界面和命令行两种使用方式

## 文件说明

### 主要工具

1. **stock_trading_visualizer.py** - Streamlit Web界面版本
   - 功能最完整，提供友好的Web界面
   - 支持文件上传和交互式操作
   - 使用Plotly绘制交互式图表

2. **simple_stock_visualizer.py** - 命令行版本
   - 轻量级，无需Web服务器
   - 使用matplotlib绘制图表
   - 适合快速查看和批量处理

### 数据文件

- **tdx_transaction_new.csv** - 包含价格的交易数据
- **tdx_transaction2.csv** - 不包含价格的交易数据

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 方法1: Web界面版本（推荐）

```bash
streamlit run stock_trading_visualizer.py
```

然后在浏览器中打开显示的URL（通常是 http://localhost:8501）

### 方法2: 命令行版本

```bash
python simple_stock_visualizer.py
```

按照提示操作：
1. 输入CSV文件路径（或直接回车使用默认文件）
2. 选择查看所有股票概览或绘制特定股票图表

## 数据格式

支持两种CSV格式：

### 格式1（包含价格）
```
20240103,000669,1,2.28
20240103,603030,1,2.78
20240104,000669,2,2.30
```

### 格式2（不包含价格）
```
20240103,000669,1
20240103,603030,1
20240104,000669,2
```

### 字段说明
- 第1列：交易日期（YYYYMMDD格式）
- 第2列：股票代码（6位数字）
- 第3列：交易方向（1=买入，2=卖出）
- 第4列：交易价格（可选）

## 功能演示

### 主要功能

1. **数据导入**
   - 自动识别文件编码（支持UTF-8、GBK等）
   - 验证数据格式
   - 显示加载统计

2. **K线图显示**
   - 自动获取股票历史数据
   - 支持上海（6开头）和深圳（0、3开头）股票
   - 显示完整的K线图

3. **交易标记**
   - 红色向上三角形：买入点
   - 绿色向下三角形：卖出点
   - 鼠标悬停显示详细信息

4. **统计分析**
   - 总交易次数
   - 买入/卖出次数统计
   - 交易明细列表
   - 所有股票概览

## 注意事项

1. **网络连接**：需要联网获取股票数据
2. **股票代码**：支持A股股票代码格式
3. **数据来源**：使用Yahoo Finance API获取股票数据
4. **编码问题**：工具会自动尝试多种编码格式

## 故障排除

### 常见问题

1. **无法获取股票数据**
   - 检查网络连接
   - 确认股票代码格式正确
   - 某些股票可能在Yahoo Finance上没有数据

2. **CSV文件读取失败**
   - 检查文件路径是否正确
   - 确认文件格式符合要求
   - 尝试转换文件编码为UTF-8

3. **图表显示异常**
   - 确保安装了所有依赖包
   - 检查数据日期范围是否合理

## 扩展功能

可以根据需要添加以下功能：
- 盈亏计算
- 技术指标分析
- 批量图表生成
- 数据导出功能
- 更多图表类型

## 技术栈

- **Python 3.7+**
- **Streamlit** - Web界面框架
- **Plotly** - 交互式图表
- **matplotlib** - 静态图表
- **pandas** - 数据处理
- **yfinance** - 股票数据获取